<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Ted's Strength</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@400;500&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0d0f;
    --surface: #141418;
    --surface2: #1e1e24;
    --border: #2a2a33;
    --accent: #e8402a;
    --accent2: #f5a623;
    --green: #27c47a;
    --text: #f0f0f0;
    --muted: #888;
    --card-shadow: 0 4px 24px rgba(0,0,0,0.5);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* â”€â”€ SCREENS â”€â”€ */
  .screen { display: none; min-height: 100vh; padding-bottom: 80px; }
  .screen.active { display: block; }

  /* â”€â”€ NAV â”€â”€ */
  nav {
    position: fixed; bottom: 0; left: 0; right: 0; z-index: 100;
    background: var(--surface);
    border-top: 1px solid var(--border);
    display: flex;
    height: 68px;
    padding-bottom: env(safe-area-inset-bottom);
  }
  .nav-btn {
    flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;
    gap: 4px; background: none; border: none; cursor: pointer;
    color: var(--muted); font-family: 'DM Sans', sans-serif;
    font-size: 10px; font-weight: 500; letter-spacing: 0.05em; text-transform: uppercase;
    transition: color 0.15s;
  }
  .nav-btn.active { color: var(--accent); }
  .nav-btn svg { width: 22px; height: 22px; stroke-width: 1.8; }

  /* â”€â”€ HEADER â”€â”€ */
  .page-header {
    padding: 56px 20px 20px;
    background: linear-gradient(180deg, #141418 0%, transparent 100%);
  }
  .page-header h1 {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 42px; letter-spacing: 0.04em;
    line-height: 1;
  }
  .page-header .sub {
    color: var(--muted); font-size: 12px; letter-spacing: 0.08em;
    text-transform: uppercase; margin-top: 4px;
  }

  /* â”€â”€ CARDS â”€â”€ */
  .card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 12px; padding: 18px 20px;
    margin: 0 16px 12px;
    box-shadow: var(--card-shadow);
  }
  .card-label {
    font-size: 10px; text-transform: uppercase; letter-spacing: 0.1em;
    color: var(--muted); margin-bottom: 8px;
  }

  /* â”€â”€ TODAY SCREEN â”€â”€ */
  .day-selector {
    display: flex; gap: 8px; padding: 0 16px 16px; overflow-x: auto;
    scrollbar-width: none;
  }
  .day-selector::-webkit-scrollbar { display: none; }
  .day-pill {
    flex-shrink: 0; padding: 8px 20px; border-radius: 100px;
    border: 1px solid var(--border); background: var(--surface);
    color: var(--muted); font-family: 'DM Mono', monospace;
    font-size: 12px; cursor: pointer; transition: all 0.15s;
    white-space: nowrap;
  }
  .day-pill.active {
    background: var(--accent); border-color: var(--accent);
    color: white; font-weight: 500;
  }

  .exercise-card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 12px; margin: 0 16px 10px;
    overflow: hidden;
  }
  .ex-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 14px 16px; cursor: pointer;
  }
  .ex-name {
    font-weight: 600; font-size: 15px;
  }
  .ex-meta {
    font-size: 11px; color: var(--muted); margin-top: 2px;
    font-family: 'DM Mono', monospace;
  }
  .ex-badge {
    font-family: 'Bebas Neue', sans-serif;
    font-size: 13px; letter-spacing: 0.05em;
    padding: 4px 10px; border-radius: 6px;
    background: var(--surface2); color: var(--accent2);
    white-space: nowrap;
  }
  .ex-body {
    display: none; border-top: 1px solid var(--border);
    padding: 14px 16px;
  }
  .ex-body.open { display: block; }

  .set-row {
    display: flex; align-items: center; gap: 10px; margin-bottom: 10px;
  }
  .set-label {
    font-family: 'DM Mono', monospace; font-size: 11px;
    color: var(--muted); width: 36px; flex-shrink: 0;
  }
  .set-input {
    flex: 1; background: var(--surface2); border: 1px solid var(--border);
    border-radius: 8px; padding: 10px 12px;
    color: var(--text); font-family: 'DM Mono', monospace;
    font-size: 14px; text-align: center;
    -webkit-appearance: none; appearance: none;
    transition: border-color 0.15s;
  }
  .set-input:focus { outline: none; border-color: var(--accent); }
  .set-input::placeholder { color: var(--muted); font-size: 12px; }
  .set-complete-btn {
    width: 36px; height: 36px; border-radius: 50%;
    border: 2px solid var(--border); background: none;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all 0.15s; flex-shrink: 0;
    color: var(--border);
  }
  .set-complete-btn.done {
    background: var(--green); border-color: var(--green); color: white;
  }

  .coach-tip {
    background: var(--surface2); border-left: 3px solid var(--accent2);
    border-radius: 0 8px 8px 0; padding: 10px 12px; margin-top: 12px;
    font-size: 12px; color: var(--muted); line-height: 1.5;
  }

  .amrap-tag {
    display: inline-block; background: var(--accent);
    color: white; font-family: 'Bebas Neue', sans-serif;
    font-size: 11px; letter-spacing: 0.1em;
    padding: 2px 8px; border-radius: 4px; margin-left: 6px;
  }

  /* â”€â”€ SESSION COMPLETE â”€â”€ */
  .session-done-btn {
    margin: 20px 16px 0;
    width: calc(100% - 32px);
    padding: 16px; border-radius: 12px;
    background: var(--accent); border: none;
    color: white; font-family: 'Bebas Neue', sans-serif;
    font-size: 20px; letter-spacing: 0.08em;
    cursor: pointer; transition: opacity 0.15s;
  }
  .session-done-btn:active { opacity: 0.8; }

  /* â”€â”€ PROGRESS SCREEN â”€â”€ */
  .goal-bar-wrap { margin-top: 6px; }
  .goal-bar-track {
    height: 8px; background: var(--surface2); border-radius: 100px;
    overflow: hidden; margin-top: 6px;
  }
  .goal-bar-fill {
    height: 100%; border-radius: 100px;
    background: linear-gradient(90deg, var(--accent), var(--accent2));
    transition: width 0.6s ease;
  }
  .goal-nums {
    display: flex; justify-content: space-between;
    font-family: 'DM Mono', monospace; font-size: 11px; color: var(--muted);
    margin-top: 4px;
  }
  .lift-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 0 16px 12px; }
  .lift-stat {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 12px; padding: 14px 16px;
  }
  .lift-stat-val {
    font-family: 'Bebas Neue', sans-serif; font-size: 36px;
    color: var(--text); line-height: 1;
  }
  .lift-stat-unit { font-size: 14px; color: var(--muted); margin-left: 2px; }
  .lift-stat-label { font-size: 11px; color: var(--muted); margin-top: 4px; letter-spacing: 0.06em; text-transform: uppercase; }
  .lift-stat-delta {
    font-size: 11px; font-family: 'DM Mono', monospace;
    margin-top: 6px;
  }
  .delta-up { color: var(--green); }
  .delta-none { color: var(--muted); }

  /* â”€â”€ HISTORY â”€â”€ */
  .log-entry {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 10px; margin: 0 16px 8px; padding: 14px 16px;
  }
  .log-date {
    font-family: 'DM Mono', monospace; font-size: 11px;
    color: var(--muted); margin-bottom: 4px;
  }
  .log-day-tag {
    display: inline-block;
    font-family: 'Bebas Neue', sans-serif; font-size: 12px;
    letter-spacing: 0.08em; padding: 2px 8px; border-radius: 4px;
    margin-bottom: 8px;
  }
  .tag-A { background: #1a3a5c; color: #5b9bd5; }
  .tag-B { background: #3a1a1a; color: var(--accent); }
  .tag-C { background: #1a3a2a; color: var(--green); }
  .log-lifts { font-size: 13px; color: var(--muted); line-height: 1.7; }
  .log-lifts strong { color: var(--text); }

  /* â”€â”€ SETTINGS â”€â”€ */
  .tm-input-row {
    display: flex; align-items: center; gap: 12px; margin-bottom: 12px;
  }
  .tm-label { flex: 1; font-size: 14px; font-weight: 500; }
  .tm-val {
    font-family: 'DM Mono', monospace; font-size: 13px;
    color: var(--accent2); width: 56px; text-align: right;
  }
  .tm-input {
    width: 80px; background: var(--surface2); border: 1px solid var(--border);
    border-radius: 8px; padding: 8px 10px; color: var(--text);
    font-family: 'DM Mono', monospace; font-size: 13px; text-align: center;
    -webkit-appearance: none;
  }
  .tm-input:focus { outline: none; border-color: var(--accent); }

  .save-btn {
    width: 100%; padding: 14px; border-radius: 10px;
    background: var(--surface2); border: 1px solid var(--border);
    color: var(--text); font-family: 'DM Sans', sans-serif;
    font-size: 14px; font-weight: 600; cursor: pointer;
    transition: background 0.15s; margin-top: 4px;
  }
  .save-btn:active { background: var(--border); }
  .save-btn.primary { background: var(--accent); border-color: var(--accent); color: white; }

  /* â”€â”€ MISC â”€â”€ */
  .tag {
    display: inline-flex; align-items: center; gap: 4px;
    font-size: 10px; text-transform: uppercase; letter-spacing: 0.08em;
    padding: 3px 8px; border-radius: 4px; font-weight: 600;
  }
  .tag-day-A { background: #1a3a5c; color: #5b9bd5; }
  .tag-day-B { background: #3a1a1a; color: var(--accent); }
  .tag-day-C { background: #1a3a2a; color: var(--green); }

  .week-badge {
    font-family: 'Bebas Neue', sans-serif; font-size: 22px;
    color: var(--accent);
  }

  .empty-state {
    text-align: center; padding: 60px 20px;
    color: var(--muted); font-size: 14px; line-height: 1.6;
  }
  .empty-state svg { margin-bottom: 16px; opacity: 0.3; }

  .divider { height: 1px; background: var(--border); margin: 8px 0; }

  input[type=number]::-webkit-inner-spin-button,
  input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; }

  .toast {
    position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%) translateY(20px);
    background: var(--green); color: white; padding: 12px 20px; border-radius: 10px;
    font-weight: 600; font-size: 14px; opacity: 0; transition: all 0.3s;
    z-index: 200; white-space: nowrap;
  }
  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

  .ramp-guide {
    background: var(--surface2); border-radius: 8px; padding: 12px 14px; margin-top: 10px;
  }
  .ramp-title { font-size: 10px; text-transform: uppercase; letter-spacing: 0.1em; color: var(--muted); margin-bottom: 8px; }
  .ramp-row {
    display: flex; justify-content: space-between; align-items: center;
    font-family: 'DM Mono', monospace; font-size: 12px;
    padding: 3px 0; border-bottom: 1px solid var(--border);
  }
  .ramp-row:last-child { border-bottom: none; }
  .ramp-pct { color: var(--muted); }
  .ramp-weight { color: var(--accent2); font-weight: 500; }

  /* â”€â”€ WARMUP CARD â”€â”€ */
  .warmup-card {
    background: var(--surface); border: 1px solid var(--border);
    border-radius: 12px; margin: 0 16px 10px; overflow: hidden;
  }
  .warmup-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: 14px 16px; cursor: pointer;
  }
  .warmup-title-row { display: flex; align-items: center; gap: 10px; }
  .warmup-icon {
    width: 32px; height: 32px; border-radius: 8px;
    background: #1e2a1e; display: flex; align-items: center; justify-content: center;
    font-size: 16px; flex-shrink: 0;
  }
  .warmup-label { font-weight: 600; font-size: 15px; }
  .warmup-sublabel { font-size: 11px; color: var(--muted); margin-top: 2px; font-family: 'DM Mono', monospace; }
  .warmup-badge {
    font-family: 'Bebas Neue', sans-serif; font-size: 13px; letter-spacing: 0.05em;
    padding: 4px 10px; border-radius: 6px;
    background: #1a3a2a; color: var(--green); white-space: nowrap;
  }
  .warmup-body { display: none; border-top: 1px solid var(--border); padding: 14px 16px; }
  .warmup-body.open { display: block; }
  .warmup-step {
    display: flex; gap: 12px; padding: 10px 0;
    border-bottom: 1px solid var(--border);
  }
  .warmup-step:last-child { border-bottom: none; padding-bottom: 0; }
  .warmup-step-num {
    width: 24px; height: 24px; border-radius: 50%;
    background: var(--surface2); border: 1px solid var(--border);
    font-family: 'DM Mono', monospace; font-size: 11px; color: var(--muted);
    display: flex; align-items: center; justify-content: center; flex-shrink: 0;
    margin-top: 1px;
  }
  .warmup-step-content { flex: 1; }
  .warmup-step-name { font-size: 13px; font-weight: 600; margin-bottom: 2px; }
  .warmup-step-detail { font-size: 12px; color: var(--muted); line-height: 1.5; }
  .warmup-step-detail em { color: var(--accent2); font-style: normal; font-family: 'DM Mono', monospace; }
  .warmup-step-done-btn {
    width: 28px; height: 28px; border-radius: 50%;
    border: 2px solid var(--border); background: none;
    cursor: pointer; display: flex; align-items: center; justify-content: center;
    transition: all 0.15s; flex-shrink: 0; color: var(--border); margin-top: 2px;
  }
  .warmup-step-done-btn.done { background: var(--green); border-color: var(--green); color: white; }
  .warmup-note {
    background: var(--surface2); border-left: 3px solid var(--green);
    border-radius: 0 8px 8px 0; padding: 10px 12px; margin-top: 12px;
    font-size: 12px; color: var(--muted); line-height: 1.5;
  }
</style>
</head>
<body>

<!-- TODAY -->
<div id="screen-today" class="screen active">
  <div class="page-header">
    <div style="display:flex;justify-content:space-between;align-items:flex-start">
      <div>
        <h1>TODAY</h1>
        <div class="sub" id="today-date"></div>
      </div>
      <div style="text-align:right">
        <div class="week-badge" id="week-badge">WK 1</div>
        <div style="font-size:11px;color:var(--muted);margin-top:2px" id="session-count-label"></div>
      </div>
    </div>
  </div>

  <div class="day-selector" id="day-selector">
    <div class="day-pill active" data-day="A" onclick="selectDay('A',this)">Day A Â· Squat</div>
    <div class="day-pill" data-day="B" onclick="selectDay('B',this)">Day B Â· Bench</div>
    <div class="day-pill" data-day="C" onclick="selectDay('C',this)">Day C Â· Deadlift</div>
  </div>

  <div id="exercises-container"></div>

  <button class="session-done-btn" onclick="finishSession()">âœ“ Log This Session</button>
</div>

<!-- PROGRESS -->
<div id="screen-progress" class="screen">
  <div class="page-header">
    <h1>PROGRESS</h1>
    <div class="sub">Strength goals tracker</div>
  </div>
  <div id="progress-content"></div>
</div>

<!-- HISTORY -->
<div id="screen-history" class="screen">
  <div class="page-header">
    <h1>HISTORY</h1>
    <div class="sub">All logged sessions</div>
  </div>
  <div id="history-content"></div>
</div>

<!-- SETTINGS -->
<div id="screen-settings" class="screen">
  <div class="page-header">
    <h1>SETUP</h1>
    <div class="sub">Training maxes & week</div>
  </div>
  <div class="card">
    <div class="card-label">Current Week</div>
    <div class="tm-input-row">
      <div class="tm-label">Program Week</div>
      <input type="number" class="tm-input" id="set-week" min="1" max="12" value="1">
    </div>
  </div>
  <div class="card">
    <div class="card-label">Training Maxes (lbs) â€” start at 90% of your 1RM</div>
    <div id="tm-inputs"></div>
  </div>
  <div style="margin: 0 16px">
    <button class="save-btn primary" onclick="saveSettings()">Save Settings</button>
  </div>
  <div class="card" style="margin-top:12px">
    <div class="card-label">Danger Zone</div>
    <button class="save-btn" onclick="resetAll()" style="color:var(--accent)">Reset All Data</button>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<!-- NAV -->
<nav>
  <button class="nav-btn active" data-screen="today" onclick="showScreen('today',this)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
    Today
  </button>
  <button class="nav-btn" data-screen="progress" onclick="showScreen('progress',this)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/></svg>
    Progress
  </button>
  <button class="nav-btn" data-screen="history" onclick="showScreen('history',this)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/></svg>
    History
  </button>
  <button class="nav-btn" data-screen="settings" onclick="showScreen('settings',this)">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="3"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14M4.93 4.93a10 10 0 0 0 0 14.14"/></svg>
    Setup
  </button>
</nav>

<script>
// â”€â”€ DATA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const PROGRAM = {
  A: {
    label: "Day A â€” Squat Focus",
    exercises: [
      { id:"squat_main", name:"Back Squat", tag:"Main Lift", sets:3, repsScheme:"5/3/1", lift:"squat", isMain:true,
        tip:"Last set is AMRAP â€” push as many clean reps as possible. 2â€“3 min rest between sets." },
      { id:"squat_backoff", name:"Back Squat Back-Off", tag:"Volume", sets:5, repsScheme:"5", lift:"squat", pct:0.65,
        tip:"Same day, 65% TM. Controlled descent, explosive up. Builds volume without taxing CNS." },
      { id:"rdl", name:"Romanian Deadlift", tag:"Accessory", sets:3, repsScheme:"8", fixedWeight:true,
        tip:"Hinge at hip, slight knee bend. Load hamstrings fully. No lower back rounding." },
      { id:"leg_press", name:"Leg Press", tag:"Accessory", sets:3, repsScheme:"10", fixedWeight:true,
        tip:"Heels shoulder-width. Full range. Drive through whole foot â€” don't just use your toes." },
      { id:"leg_curl", name:"Leg Curl", tag:"Accessory", sets:3, repsScheme:"12", fixedWeight:true,
        tip:"3-second eccentric (lower slowly). Hamstring health = healthy squat." },
      { id:"plank", name:"Plank / Ab Wheel", tag:"Core", sets:3, repsScheme:"30â€“45s / 10 reps", fixedWeight:true,
        tip:"Brace like you're about to take a punch. Core strength transfers directly to squat." },
    ]
  },
  B: {
    label: "Day B â€” Bench Focus",
    exercises: [
      { id:"bench_main", name:"Bench Press", tag:"Main Lift", sets:3, repsScheme:"5/3/1", lift:"bench", isMain:true,
        tip:"Last set AMRAP. Retract scaps, full leg drive, controlled descent to lower chest." },
      { id:"bench_backoff", name:"Bench Press Back-Off", tag:"Volume", sets:5, repsScheme:"5", lift:"bench", pct:0.65,
        tip:"Speed reps â€” explode up. 65% TM. Builds power and bar confidence." },
      { id:"barbell_row", name:"Barbell Row", tag:"Accessory", sets:4, repsScheme:"6â€“8", fixedWeight:true,
        tip:"Overhand, elbows at 45Â°. Row to lower chest. Scapular retraction = shoulder health." },
      { id:"incline_db", name:"Incline DB Press", tag:"Accessory", sets:3, repsScheme:"10", fixedWeight:true,
        tip:"30Â° incline only. Fills the upper pec gap that flat bench misses." },
      { id:"lat_pulldown", name:"Lat Pulldown", tag:"Accessory", sets:3, repsScheme:"10â€“12", fixedWeight:true,
        tip:"Full stretch at top. Lat strength stabilizes your shoulder on heavy bench." },
      { id:"tricep_face", name:"Tricep Pushdown + Face Pulls", tag:"Health", sets:2, repsScheme:"15 each", fixedWeight:true,
        tip:"Superset to save time. Non-negotiable for elbow and shoulder longevity as weight goes up." },
    ]
  },
  C: {
    label: "Day C â€” Deadlift + Overhead",
    exercises: [
      { id:"deadlift_main", name:"Deadlift", tag:"Main Lift", sets:3, repsScheme:"5/3/1", lift:"deadlift", isMain:true,
        tip:"Drive the floor away â€” don't think of it as a pull. Hips and shoulders rise together." },
      { id:"ohp_main", name:"Overhead Press", tag:"Main Lift", sets:3, repsScheme:"5/3/1", lift:"ohp", isMain:true,
        tip:"Bar slightly in front on descent. Glutes squeezed. No hip drive â€” strict press only." },
      { id:"trap_squat", name:"Trap Bar / Goblet Squat", tag:"Accessory", sets:3, repsScheme:"8", fixedWeight:true,
        tip:"Reinforces squat pattern. Sub goblet squat if no trap bar available." },
      { id:"chinup", name:"Chin-Ups / Lat Pulldown", tag:"Accessory", sets:3, repsScheme:"Max / 8â€“10", fixedWeight:true,
        tip:"Chin-ups if you can do 5+, lat pulldown otherwise. Full ROM every rep." },
      { id:"db_shoulder", name:"DB Shoulder Press", tag:"Accessory", sets:2, repsScheme:"12", fixedWeight:true,
        tip:"Shoulder health volume. Controlled â€” no ego here." },
      { id:"farmer_carry", name:"Farmer Carry", tag:"Finisher", sets:3, repsScheme:"40 yards", fixedWeight:true,
        tip:"Go heavy. Shoulders packed, core braced. Builds grip, core, and mental toughness." },
    ]
  }
};

const WARMUPS = {
  A: {
    note: "~8 min total. Do this before touching a barbell. Your nervous system needs it.",
    steps: [
      { name: "Foam Roll", detail: "Quads, IT band, thoracic spine â€” <em>2 min</em>. Can skip if short on time; yoga covers this adequately." },
      { name: "Hip Circles + Leg Swings", detail: "<em>10 reps each direction</em> per leg. Opens the hips before loading. Non-negotiable on squat day." },
      { name: "Bodyweight Squat", detail: "<em>2 Ã— 10 reps</em>. Slow and controlled. Feel the pattern before adding load." },
      { name: "Squat Ramp Sets", detail: "Bar Ã— 10 â†’ <em>50% TM Ã— 5</em> â†’ <em>70% TM Ã— 3</em> â†’ <em>85% TM Ã— 1</em> â†’ work set. Calculated weights show under the main lift." },
    ]
  },
  B: {
    note: "~8 min. The band pull-aparts are the most important thing you'll do for long-term shoulder health.",
    steps: [
      { name: "Foam Roll â€” Thoracic Spine", detail: "<em>60â€“90 sec</em>. T-spine mobility directly affects how your shoulder moves on bench. 10 extensions over the roller." },
      { name: "Band Pull-Aparts", detail: "<em>2 Ã— 20 reps</em>. Arms straight out front, pull band apart to chest. Squeezes rear delts and retractors. Non-negotiable." },
      { name: "Face Pulls (warm-up dose)", detail: "<em>2 Ã— 15 reps</em> light. External rotation prep. Keeps the rotator cuff healthy as bench weight increases." },
      { name: "Bench Ramp Sets", detail: "Bar Ã— 10 â†’ <em>50% TM Ã— 5</em> â†’ <em>70% TM Ã— 3</em> â†’ <em>85% TM Ã— 1</em> â†’ work set. Calculated weights show under the main lift." },
    ]
  },
  C: {
    note: "~8 min. Deadlift day â€” hips and hamstrings need the most prep. Don't rush this.",
    steps: [
      { name: "Foam Roll â€” Hamstrings + Glutes", detail: "<em>90 sec</em>. Sit on the roller, cross one ankle over the knee, roll slowly. Both sides." },
      { name: "Hip Hinge Practice", detail: "<em>2 Ã— 10 reps</em> bodyweight. Stand with feet hip-width, push hips back to wall behind you. Feel the hamstring load â€” that's the deadlift pattern." },
      { name: "Band Pull-Aparts", detail: "<em>1 Ã— 20 reps</em>. Even on deadlift day â€” shoulders need priming for overhead press that follows." },
      { name: "Deadlift Ramp Sets", detail: "Bar Ã— 10 â†’ <em>50% TM Ã— 5</em> â†’ <em>70% TM Ã— 3</em> â†’ <em>85% TM Ã— 1</em> â†’ work set." },
      { name: "OHP Ramp Sets", detail: "Bar Ã— 10 â†’ <em>50% TM Ã— 5</em> â†’ <em>70% TM Ã— 3</em> â†’ work set. Do these after deadlift main sets." },
    ]
  }
};

const GOALS = { bench: 225, squat: 300, deadlift: 315, ohp: 155 };
const LIFT_LABELS = { bench: "Bench Press", squat: "Back Squat", deadlift: "Deadlift", ohp: "Overhead Press" };

// 5/3/1 percentages by week (cycling weeks 1-3, deload week 4-ish handled manually)
const WEEK_PCTS = {
  1: [0.65, 0.75, 0.85],
  2: [0.70, 0.80, 0.90],
  3: [0.75, 0.85, 0.95],
  4: [0.65, 0.75, 0.85], // restart cycle, bump TM
  5: [0.70, 0.80, 0.90],
  6: [0.75, 0.85, 0.95],
  7: [0.65, 0.75, 0.85],
  8: [0.70, 0.80, 0.90],
  9: [0.75, 0.85, 0.95],
  10:[0.65, 0.75, 0.85],
  11:[0.70, 0.80, 0.90],
  12:[0.75, 0.85, 0.95],
};
const WEEK_REPS = {
  1:[5,5,"5+"], 2:[3,3,"3+"], 3:[5,3,"1+"],
  4:[5,5,"5+"], 5:[3,3,"3+"], 6:[5,3,"1+"],
  7:[5,5,"5+"], 8:[3,3,"3+"], 9:[5,3,"1+"],
  10:[5,5,"5+"],11:[3,3,"3+"],12:[5,3,"1+"],
};

// â”€â”€ STATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function loadState() {
  return JSON.parse(localStorage.getItem('ted_strength') || JSON.stringify({
    week: 1,
    tm: { bench: 185, squat: 288, deadlift: 234, ohp: 122 }, // 90% of baselines
    sessions: [],
    currentDay: 'A',
    currentSets: {}
  }));
}
function saveState(s) { localStorage.setItem('ted_strength', JSON.stringify(s)); }
let STATE = loadState();
let currentDay = STATE.currentDay || 'A';
let currentSets = {}; // { exId: { set0: {w, r, done}, ... } }

// â”€â”€ UTILS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function round5(n) { return Math.round(n / 5) * 5; }
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg; t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}
function fmtDate(iso) {
  const d = new Date(iso);
  return d.toLocaleDateString('en-US', { weekday:'short', month:'short', day:'numeric' });
}

// â”€â”€ SCREENS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showScreen(name, btn) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('screen-' + name).classList.add('active');
  btn.classList.add('active');
  if (name === 'progress') renderProgress();
  if (name === 'history') renderHistory();
  if (name === 'settings') renderSettings();
}

// â”€â”€ TODAY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function selectDay(day, el) {
  currentDay = day;
  STATE.currentDay = day;
  saveState(STATE);
  document.querySelectorAll('.day-pill').forEach(p => p.classList.remove('active'));
  el.classList.add('active');
  renderExercises();
}

function renderTodayHeader() {
  const now = new Date();
  document.getElementById('today-date').textContent =
    now.toLocaleDateString('en-US', { weekday:'long', month:'long', day:'numeric' });
  document.getElementById('week-badge').textContent = 'WK ' + STATE.week;
  const wkSessions = STATE.sessions.filter(s => {
    const d = new Date(s.date);
    const now = new Date();
    const startOfWeek = new Date(now); startOfWeek.setDate(now.getDate() - now.getDay());
    return d >= startOfWeek;
  }).length;
  document.getElementById('session-count-label').textContent = wkSessions + ' sessions this week';
}

function calcWorkWeight(lift, setIndex) {
  const tm = STATE.tm[lift] || 100;
  const week = Math.min(STATE.week, 12);
  const pcts = WEEK_PCTS[week] || WEEK_PCTS[1];
  return round5(tm * pcts[setIndex]);
}

function renderWarmupCard(day, container) {
  const wu = WARMUPS[day];
  const stepHTML = wu.steps.map((s, i) => `
    <div class="warmup-step">
      <div class="warmup-step-num">${i+1}</div>
      <div class="warmup-step-content">
        <div class="warmup-step-name">${s.name}</div>
        <div class="warmup-step-detail">${s.detail}</div>
      </div>
      <button class="warmup-step-done-btn" onclick="this.classList.toggle('done')">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20,6 9,17 4,12"/></svg>
      </button>
    </div>`).join('');

  const card = document.createElement('div');
  card.className = 'warmup-card';
  card.innerHTML = `
    <div class="warmup-header" onclick="this.nextElementSibling.classList.toggle('open')">
      <div class="warmup-title-row">
        <div class="warmup-icon">ðŸ”¥</div>
        <div>
          <div class="warmup-label">Warm-Up Protocol</div>
          <div class="warmup-sublabel">${wu.steps.length} steps Â· ~8 min</div>
        </div>
      </div>
      <div class="warmup-badge">DO FIRST</div>
    </div>
    <div class="warmup-body">
      ${stepHTML}
      <div class="warmup-note">ðŸ’¡ ${wu.note}</div>
    </div>`;
  container.appendChild(card);
}

function renderExercises() {
  renderTodayHeader();
  const day = PROGRAM[currentDay];
  const container = document.getElementById('exercises-container');
  container.innerHTML = '';
  const week = Math.min(STATE.week, 12);
  const reps = WEEK_REPS[week] || WEEK_REPS[1];

  renderWarmupCard(currentDay, container);

  day.exercises.forEach(ex => {
    const card = document.createElement('div');
    card.className = 'exercise-card';

    // Build sets info
    let setsHTML = '';
    const numSets = ex.sets;

    if (ex.isMain) {
      const pcts = WEEK_PCTS[week] || WEEK_PCTS[1];
      // Ramp guide
      const liftTM = STATE.tm[ex.lift] || 100;
      const rampWeights = [
        { pct: 'Bar', w: 'Bar' },
        { pct: '50%', w: round5(liftTM * 0.50) + ' lbs' },
        { pct: '70%', w: round5(liftTM * 0.70) + ' lbs' },
        { pct: '85%', w: round5(liftTM * 0.85) + ' lbs' },
      ];
      const rampHTML = rampWeights.map(r =>
        `<div class="ramp-row"><span class="ramp-pct">${r.pct} warm-up</span><span class="ramp-weight">${r.w}</span></div>`
      ).join('');

      for (let i = 0; i < 3; i++) {
        const w = round5(liftTM * pcts[i]);
        const r = reps[i];
        const isLast = i === 2;
        const key = ex.id + '_set' + i;
        const saved = (currentSets[key] || {});
        setsHTML += `
          <div class="set-row">
            <div class="set-label">Set ${i+1}</div>
            <input class="set-input" type="number" inputmode="numeric" placeholder="${w} lbs" value="${saved.w||''}" id="w_${key}" style="max-width:90px">
            <input class="set-input" type="number" inputmode="numeric" placeholder="${r} reps${isLast?' AMRAP':''}" value="${saved.r||''}" id="r_${key}" style="max-width:90px">
            <button class="set-complete-btn ${saved.done?'done':''}" onclick="toggleSet('${key}',this)" id="btn_${key}">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20,6 9,17 4,12"/></svg>
            </button>
          </div>`;
      }
      setsHTML += `
        <div class="ramp-guide">
          <div class="ramp-title">Warm-up ramps</div>
          ${rampHTML}
        </div>`;
    } else if (ex.pct) {
      const w = round5((STATE.tm[ex.lift] || 100) * ex.pct);
      for (let i = 0; i < numSets; i++) {
        const key = ex.id + '_set' + i;
        const saved = (currentSets[key] || {});
        setsHTML += `
          <div class="set-row">
            <div class="set-label">Set ${i+1}</div>
            <input class="set-input" type="number" inputmode="numeric" placeholder="${w} lbs" value="${saved.w||''}" id="w_${key}" style="max-width:100px">
            <input class="set-input" type="number" inputmode="numeric" placeholder="${ex.repsScheme} reps" value="${saved.r||''}" id="r_${key}" style="max-width:100px">
            <button class="set-complete-btn ${saved.done?'done':''}" onclick="toggleSet('${key}',this)" id="btn_${key}">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20,6 9,17 4,12"/></svg>
            </button>
          </div>`;
      }
    } else {
      for (let i = 0; i < numSets; i++) {
        const key = ex.id + '_set' + i;
        const saved = (currentSets[key] || {});
        setsHTML += `
          <div class="set-row">
            <div class="set-label">Set ${i+1}</div>
            <input class="set-input" type="number" inputmode="numeric" placeholder="weight / reps" value="${saved.w||''}" id="w_${key}" style="max-width:110px">
            <input class="set-input" type="number" inputmode="numeric" placeholder="${ex.repsScheme}" value="${saved.r||''}" id="r_${key}" style="max-width:90px">
            <button class="set-complete-btn ${saved.done?'done':''}" onclick="toggleSet('${key}',this)" id="btn_${key}">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><polyline points="20,6 9,17 4,12"/></svg>
            </button>
          </div>`;
      }
    }

    const tagColor = currentDay === 'A' ? '#1a3a5c' : currentDay === 'B' ? '#3a1a1a' : '#1a3a2a';
    const tagText = currentDay === 'A' ? '#5b9bd5' : currentDay === 'B' ? 'var(--accent)' : 'var(--green)';

    card.innerHTML = `
      <div class="ex-header" onclick="toggleEx(this)">
        <div>
          <div class="ex-name">${ex.name}</div>
          <div class="ex-meta">${ex.sets} sets Â· ${ex.repsScheme}</div>
        </div>
        <div class="ex-badge" style="background:${tagColor};color:${tagText}">${ex.tag}</div>
      </div>
      <div class="ex-body">
        ${setsHTML}
        <div class="coach-tip">ðŸ’¡ ${ex.tip}</div>
      </div>`;
    container.appendChild(card);
  });
}

function toggleEx(header) {
  const body = header.nextElementSibling;
  body.classList.toggle('open');
}

function toggleSet(key, btn) {
  const w = document.getElementById('w_' + key)?.value;
  const r = document.getElementById('r_' + key)?.value;
  currentSets[key] = { w, r, done: !btn.classList.contains('done') };
  btn.classList.toggle('done');
}

function finishSession() {
  const day = PROGRAM[currentDay];
  const sets = {};
  day.exercises.forEach(ex => {
    const numSets = ex.isMain ? 3 : ex.sets;
    for (let i = 0; i < numSets; i++) {
      const key = ex.id + '_set' + i;
      const w = document.getElementById('w_' + key)?.value;
      const r = document.getElementById('r_' + key)?.value;
      if (w || r) sets[key] = { w, r, exName: ex.name };
    }
  });

  // Estimate 1RMs from AMRAP top sets
  const orm = {};
  ['bench','squat','deadlift','ohp'].forEach(lift => {
    const ex = day.exercises.find(e => e.lift === lift && e.isMain);
    if (ex) {
      const key = ex.id + '_set2';
      const d = sets[key];
      if (d && d.w && d.r) {
        orm[lift] = Math.round(parseFloat(d.w) * (1 + parseFloat(d.r) / 30));
      }
    }
  });

  STATE.sessions.push({
    date: new Date().toISOString(),
    day: currentDay,
    week: STATE.week,
    sets,
    orm
  });

  currentSets = {};
  saveState(STATE);
  showToast('Session logged! ðŸ’ª');
  renderExercises();
}

// â”€â”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderProgress() {
  const container = document.getElementById('progress-content');
  const lifts = ['bench','squat','deadlift','ohp'];

  // Find best 1RM estimate per lift from all sessions
  const best = {};
  const recent = {};
  STATE.sessions.forEach(s => {
    if (s.orm) {
      lifts.forEach(l => {
        if (s.orm[l]) {
          if (!best[l] || s.orm[l] > best[l]) best[l] = s.orm[l];
          recent[l] = s.orm[l];
        }
      });
    }
  });

  // TM-based estimates if no session data
  lifts.forEach(l => {
    if (!best[l]) best[l] = Math.round(STATE.tm[l] / 0.9);
  });

  let html = `<div class="lift-grid">`;
  lifts.forEach(l => {
    const cur = best[l] || 0;
    const goal = GOALS[l];
    const pct = Math.min(100, Math.round((cur / goal) * 100));
    const delta = recent[l] && recent[l] !== cur ? `+${recent[l] - cur} recent` : '';
    html += `
      <div class="lift-stat">
        <div class="lift-stat-val">${cur}<span class="lift-stat-unit">lb</span></div>
        <div class="lift-stat-label">${LIFT_LABELS[l]}</div>
        <div class="goal-bar-track"><div class="goal-bar-fill" style="width:${pct}%"></div></div>
        <div class="goal-nums"><span>${pct}% to goal</span><span>Goal: ${goal}</span></div>
      </div>`;
  });
  html += `</div>`;

  // Session streak
  const total = STATE.sessions.length;
  const thisWeek = STATE.sessions.filter(s => {
    const d = new Date(s.date);
    const now = new Date();
    const sow = new Date(now); sow.setDate(now.getDate() - now.getDay());
    return d >= sow;
  }).length;

  html += `
    <div class="card">
      <div class="card-label">Training Summary</div>
      <div style="display:flex;gap:20px;margin-top:4px">
        <div><div style="font-family:'Bebas Neue',sans-serif;font-size:32px;color:var(--accent)">${total}</div><div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.06em">Total Sessions</div></div>
        <div><div style="font-family:'Bebas Neue',sans-serif;font-size:32px;color:var(--accent2)">${thisWeek}</div><div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.06em">This Week</div></div>
        <div><div style="font-family:'Bebas Neue',sans-serif;font-size:32px;color:var(--green)">WK${STATE.week}</div><div style="font-size:11px;color:var(--muted);text-transform:uppercase;letter-spacing:.06em">Current Week</div></div>
      </div>
    </div>`;

  container.innerHTML = html;
}

// â”€â”€ HISTORY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderHistory() {
  const container = document.getElementById('history-content');
  if (!STATE.sessions.length) {
    container.innerHTML = `<div class="empty-state">
      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><polyline points="12,6 12,12 16,14"/></svg>
      <div>No sessions logged yet.<br>Complete a workout to see it here.</div>
    </div>`;
    return;
  }

  const sessions = [...STATE.sessions].reverse();
  let html = '';
  sessions.forEach(s => {
    const mainLifts = Object.values(s.sets || {})
      .filter((v,i,arr) => arr.findIndex(x => x.exName === v.exName) === i)
      .filter(v => v.w)
      .slice(0, 4)
      .map(v => `<strong>${v.exName}</strong>: ${v.w} lbs Ã— ${v.r} reps`)
      .join('<br>');
    html += `
      <div class="log-entry">
        <div class="log-date">${fmtDate(s.date)} Â· Week ${s.week}</div>
        <div class="log-day-tag tag-${s.day}">Day ${s.day}</div>
        <div class="log-lifts">${mainLifts || 'Session logged'}</div>
      </div>`;
  });
  container.innerHTML = html;
}

// â”€â”€ SETTINGS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderSettings() {
  document.getElementById('set-week').value = STATE.week;
  const lifts = ['bench','squat','deadlift','ohp'];
  const labels = { bench:'Bench Press TM', squat:'Back Squat TM', deadlift:'Deadlift TM', ohp:'Overhead Press TM' };
  let html = '';
  lifts.forEach(l => {
    html += `
      <div class="tm-input-row">
        <div class="tm-label">${labels[l]}</div>
        <div class="tm-val">${STATE.tm[l]} lbs</div>
        <input class="tm-input" type="number" inputmode="numeric" id="tm_${l}" value="${STATE.tm[l]}">
      </div>`;
  });
  document.getElementById('tm-inputs').innerHTML = html;
}

function saveSettings() {
  STATE.week = parseInt(document.getElementById('set-week').value) || 1;
  ['bench','squat','deadlift','ohp'].forEach(l => {
    const v = parseInt(document.getElementById('tm_' + l)?.value);
    if (v) STATE.tm[l] = v;
  });
  saveState(STATE);
  showToast('Settings saved âœ“');
  renderExercises();
  renderSettings();
}

function resetAll() {
  if (confirm('Reset ALL data? This cannot be undone.')) {
    localStorage.removeItem('ted_strength');
    STATE = loadState();
    showToast('Data reset');
    renderExercises();
    renderSettings();
  }
}

// â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderExercises();
</script>
</body>
</html>
